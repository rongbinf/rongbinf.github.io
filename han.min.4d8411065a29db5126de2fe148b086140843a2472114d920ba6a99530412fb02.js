/*! 漢字標準格式 v3.2.7 | MIT License | css.hanzi.co *//*! Han.css: the CSS typography framework optimised for Hanzi */void function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,!0):"function"==typeof define&&define.amd?define(function(){return t(e,!0)}):t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function O(e,t){var s=n.create("h-char-group","biaodian cjk");return 0===e.index&&e.isEnd?s.innerHTML=t[0]:(s.innerHTML=e.text,s.classList.add("portion"),0===e.index?s.classList.add("isFirst"):e.isEnd&&s.classList.add("isEnd")),s}function S(e){var t=n.create("div"),s=e.charCodeAt(0).toString(16),a="biaodian cjk "+(e.match(i.char.biaodian.open)?"bd-open":e.match(i.char.biaodian.close)?"bd-close bd-end":e.match(i.char.biaodian.end)?"bd-end":e.match(new RegExp("("+o.biaodian.liga+")"))?"bd-liga":"");return t.innerHTML='<h-char unicode="'+s+'" class="'+a+'">'+e+"</h-char>",t.firstChild}function p(e,t){var s,o=n.create("canvas");return o.width="50",o.height="20",o.style.display="none",c.appendChild(o),s=o.getContext("2d"),s.textBaseline="top",s.font="15px "+t+", sans-serif",s.fillStyle="black",s.strokeStyle="black",s.fillText(e,0,0),{node:o,context:s,remove:function(){n.remove(o,c)}}}function M(e,t){var n,s,o,i=e.context,a=t.context;try{for(s=1;20>=s;s++)for(o=1;50>=o;o++){if("undefined"==typeof n&&i.getImageData(o,s,1,1).data[3]!==a.getImageData(o,s,1,1).data[3]){n=!1;break}if("boolean"==typeof n)break;50===o&&20===s&&"undefined"==typeof n&&(n=!0)}return e.remove(),t.remove(),e=null,t=null,n}catch{}return!1}function L(e,t,n){var e=e,t=t||"sans-serif",n=n||"辭Q";return t=p(n,t),e=p(n,e),!M(e,t)}function A(e){var s,t=n.create("!"),o=e.classList;return t.appendChild(n.clone(e)),n.tag("rt",t.firstChild).forEach(function(e){var t,i=n.create("!"),a=[];do{if(t=(t||e).previousSibling,!t||t.nodeName.match(/((?:h-)?r[ubt])/i))break;i.insertBefore(n.clone(t),i.firstChild),a.push(t)}while(!t.nodeName.match(/((?:h-)?r[ubt])/i))s=o.contains("zhuyin")?C(i,e):T(i,e);try{e.parentNode.replaceChild(s,e),a.map(n.remove)}catch{}}),w(t)}function E(e){var t=n.create("!");return t.appendChild(n.clone(e)),n.tag("rt",t.firstChild).forEach(function(e){var t,s,o=n.create("!"),i=[];do{if(t=(t||e).previousSibling,!t||t.nodeName.match(/((?:h-)?r[ubt])/i))break;o.insertBefore(n.clone(t),o.firstChild),i.push(t)}while(!t.nodeName.match(/((?:h-)?r[ubt])/i))s=n.create("rt"),s.innerHTML=f(e),e.parentNode.replaceChild(s,e)}),t.firstChild}function y(e){var t,s,o,i,a=n.create("!"),r=e.classList;return a.appendChild(n.clone(e)),t=a.firstChild,s=o=n.tag("rb",t),i=s.length,void function(e){e&&(o=n.tag("rt",e).map(function(e,t){if(s[t]){var n=C(s[t],e);try{s[t].parentNode.replaceChild(n,s[t])}catch{}return n}}),n.remove(e),t.setAttribute("rightangle","true"))}(t.querySelector("rtc.zhuyin")),n.qsa("rtc:not(.zhuyin)",t).forEach(function(e,s){var a=n.tag("rt",e).map(function(e){var d,u,c=Number(e.getAttribute("rbspan")||1),l=0,a=[];c>i&&(c=i);do{try{d=o.shift(),a.push(d)}catch{}if("undefined"==typeof d)break;l+=Number(d.getAttribute("span")||1)}while(c>l)if(l>c){if(a.length>1)return void console.error("An impossible `rbspan` value detected.",ruby);a=n.tag("rb",a[0]),o=a.slice(c).concat(o),a=a.slice(0,c),l=c}u=T(a,e,{class:r,span:l,order:s});try{a[0].parentNode.replaceChild(u,a.shift()),a.map(n.remove)}catch{}return u});o=a,1===s&&t.setAttribute("doubleline","true"),n.remove(e)}),w(a)}function w(e){var s=e.firstChild,t=n.create("h-ruby");return t.innerHTML=s.innerHTML,n.setAttr(t,s.attributes),t.normalize(),t}function k(e){if(!e instanceof Element)return e;var t=e.classList;return t.contains("pinyin")?t.add("romanization"):t.contains("romanization")?t.add("annotation"):t.contains("mps")?t.add("zhuyin"):t.contains("rightangle")&&t.add("complex"),e}function T(e,t,s){var o=n.create("h-ru"),t=n.clone(t),s=s||{};return s.annotation="true",Array.isArray(e)?o.innerHTML=e.map(function(e){return"undefined"==typeof e?"":e.outerHTML}).join("")+t.outerHTML:(o.appendChild(n.clone(e)),o.appendChild(t)),n.setAttr(o,s),o}function C(e,t){var e=n.clone(e),s=n.create("h-ru");return s.setAttribute("zhuyin",!0),s.appendChild(e),s.innerHTML+=f(t),s}function f(e){var t,n,s,o="string"==typeof e?e:e.textContent;return t=o.replace(i.zhuyin.diao,""),s=t?t.length:0,n=o.replace(t,"").replace(/[\u02C5]/g,"ˇ").replace(/[\u030D]/g,"͘"),0===s?"":'<h-zhuyin length="'+s+'" diao="'+n+'"><h-yin>'+t+"</h-yin><h-diao>"+n+"</h-diao></h-zhuyin>"}function d(){var t,e=n.create("div");return e.innerHTML=`<span>a b</span><span style="font-family: 'Han Space'">a b</span>`,c.appendChild(e),t=e.firstChild.offsetWidth!==e.lastChild.offsetWidth,n.remove(e,c),t}function g(e,t,n){return function(){var o=s.localize.writeOnCanvas(t,e),i=s.localize.writeOnCanvas(n,e);return s.localize.compareCanvases(o,i)}}function H(){return g('"Romanization Sans"',"a̍","\udb80\udc61")}function _(){return g('"Romanization Sans"',"i̍","\udb80\udc69")}function D(){return g('"Zhuyin Kaiti"',"ㆴ͘","\udb8c\uddb4")}function h(e){return function(t){var t=t||r,o=s.find(t).avoid(j);return e.forEach(function(e){o.replace(new RegExp(e[0],"ig"),function(t,s){var o=n.clone(F);return o.innerHTML="<h-inner>"+s[0]+"</h-inner>",o.setAttribute("display-as",e[1]),0===t.index?o:""})}),o}}var n,o,i,a,v,b,j,F,z,r=e.document,l=r.documentElement,c=r.body,x="3.2.7",P=["initCond","renderElem","renderHanging","renderJiya","renderHWS","correctBasicBD","substCombLigaWithPUA"],s=function(e,t){return new s.fn.init(e,t)},R=function(){return arguments[0]&&(this.context=arguments[0]),arguments[1]&&(this.condition=arguments[1]),this};s.version=x,s.fn=s.prototype={version:x,constructor:s,context:c,condition:l,routine:P,init:R,setRoutine:function(e){return Array.isArray(e)&&(this.routine=e),this},render:function(e){var t=this,e=Array.isArray(e)?e:this.routine;return e.forEach(function(e){try{"string"==typeof e?t[e]():Array.isArray(e)&&t[e.shift()].apply(t,e)}catch{}}),this}},s.fn.init.prototype=s.fn,s.init=function(){return s.init=s().render()},o={punct:{base:"[…,.;:!?‽_]",sing:"[‐-—…]",middle:"[\\/~\\-&‐-—_]",open:`['"‘“\\(\\[\xa1\xbf⸘\xab‹‚“„]`,close:`['"”’\\)\\]\xbb›‛”‟]`,end:`['"”’\\)\\]\xbb›‛”‟‼‽⁇-⁉,.;:!?]`},biaodian:{base:"[︰．、，。：；？！ー]",liga:"[—…⋯]",middle:"[\xb7＼／－゠＆・＿]",open:"[「『《〈（〔［｛【〖]",close:"[」』》〉）〕］｝】〗]",end:"[」』》〉）〕］｝】〗︰．、，。：；？！ー]"},hanzi:{base:"[一-鿿㐀-䶵㇀-㇣〇﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud800-\udbff][\udc00-\udfff]",desc:"[⿰-⿺]",radical:"[⼀-⿕⺀-⻳]"},latin:{base:"[A-Za-z0-9\xc0-\xffĀ-ſƀ-ɏⱠ-Ɀ꜠-ꟿḀ-ỿ]",combine:"[̀-́᷀-᷿]"},ellinika:{base:"[0-9Ͱ-Ͽἀ-῿]",combine:"[̀-᷀ͅ-᷿]"},kirillica:{base:"[0-9Ѐ-҂Ҋ-ӿԀ-ԯꙀ-ꙮ꙾-ꚗ]",combine:"[҃-҉ⷠ-ⷿ꙯-꙽ꚟ]"},kana:{base:"[アイウエオ-ヺあいうえお-ゔゟヿ]|\ud82c[\udc00-\udc01]",small:"[ぁぃぅぇぉァィゥェォっゃゅょゎゕゖッャュョヮヵヶㇰ-ㇿ]",combine:"[゙-゜]",half:"[ｦ-ﾟ]",mark:"[゠ゝゞ・-ヾ]"},eonmun:{base:"[가-힣]",letter:"[ᄀ-ᇿㅏ-ㅣㄱ-ㆎꥠ-ꥼힰ-ퟻ]",half:"[ﾡ-ￜ]"},zhuyin:{base:"[ㄅ-ㄭㆠ-ㆺ]",initial:"[ㄅ-ㄙㄪ-ㄬㆠ-ㆣ]",medial:"[ㄧ-ㄩ]",final:"[ㄚ-ㄩㄭㆤ-ㆳㆸ-ㆺ]",tone:"[˙ˊ˅ˇˋ˪˫]",checked:"[ㆴ-ㆷ][̍͘]?"}},i=function(){var p=`[\\x20\\t\\r\\n\\f]`,a=o.punct.open,r=(o.punct.close,o.punct.end),E=o.punct.middle,M=o.punct.sing,l=a+"|"+r+"|"+E,s=o.biaodian.open,O=o.biaodian.close,i=o.biaodian.end,_=o.biaodian.middle,y=o.biaodian.liga+"{2}",b=s+"|"+i+"|"+_,c=o.kana.base+o.kana.combine+"?",w=o.kana.small+o.kana.combine+"?",m=o.kana.half,g=o.eonmun.base+"|"+o.eonmun.letter,v=o.eonmun.half,e=o.hanzi.base+"|"+o.hanzi.desc+"|"+o.hanzi.radical+"|"+c,j=o.ellinika.combine,h=o.latin.base+j+"*",u=o.ellinika.base+j+"*",x=o.kirillica.combine,d=o.kirillica.base+x+"*",n=h+"|"+u+"|"+d,C="['’]",t=e+"|(?:"+n+"|"+C+")+",k=o.zhuyin.initial,A=o.zhuyin.medial,S=o.zhuyin.final,f=o.zhuyin.tone+"|"+o.zhuyin.checked;return{char:{punct:{all:new RegExp("("+l+")","g"),open:new RegExp("("+a+")","g"),end:new RegExp("("+r+")","g"),sing:new RegExp("("+M+")","g")},biaodian:{all:new RegExp("("+b+")","g"),open:new RegExp("("+s+")","g"),close:new RegExp("("+O+")","g"),end:new RegExp("("+i+")","g"),liga:new RegExp("("+y+")","g")},hanzi:new RegExp("("+e+")","g"),latin:new RegExp("("+h+")","ig"),ellinika:new RegExp("("+u+")","ig"),kirillica:new RegExp("("+d+")","ig"),kana:new RegExp("("+c+"|"+w+"|"+m+")","g"),eonmun:new RegExp("("+g+"|"+v+")","g")},group:{biaodian:[new RegExp("(("+b+"){2,})","g"),new RegExp("("+y+s+")","g")],punct:null,hanzi:new RegExp("("+e+")+","g"),western:new RegExp("("+h+"|"+u+"|"+d+"|"+l+")+","ig"),kana:new RegExp("("+c+"|"+w+"|"+m+")+","g"),eonmun:new RegExp("("+g+"|"+v+"|"+l+")+","g")},jinze:{hanging:new RegExp("("+O+"*|[…⋯]*)([、，。．])(?!"+i+")","ig"),touwei:new RegExp("("+s+"+)("+t+")("+i+"+)","ig"),tou:new RegExp("("+s+"+)("+t+")","ig"),wei:new RegExp("("+t+")("+i+"+)","ig"),middle:new RegExp("("+t+")("+_+")("+t+")","ig")},zhuyin:{form:new RegExp("^˙?("+k+")?("+A+")?("+S+")?("+f+")?$"),diao:new RegExp("("+f+")","g")},hws:{base:[new RegExp("("+e+")("+n+"|"+a+")","ig"),new RegExp("("+n+"|"+r+")("+e+")","ig")],strict:[new RegExp("("+e+")"+p+"?("+n+"|"+a+")","ig"),new RegExp("("+n+"|"+r+")"+p+"?("+e+")","ig")]},"display-as":{"ja-font-for-hant":["查 査","啟 啓","鄉 鄕","值 値","污 汚"],"comb-liga-pua":[["a[̍͘]","\udb80\udc61"],["e[̍͘]","\udb80\udc65"],["i[̍͘]","\udb80\udc69"],["o[̍͘]","\udb80\udc6f"],["u[̍͘]","\udb80\udc75"],["ㆴ[̍͘]","\udb8c\uddb4"],["ㆵ[̍͘]","\udb8c\uddb5"],["ㆶ[̍͘]","\udb8c\uddb6"],["ㆷ[̍͘]","\udb8c\uddb7"]],"comb-liga-vowel":[["a[̍͘]","\udb80\udc61"],["e[̍͘]","\udb80\udc65"],["i[̍͘]","\udb80\udc69"],["o[̍͘]","\udb80\udc6f"],["u[̍͘]","\udb80\udc75"]],"comb-liga-zhuyin":[["ㆴ[̍͘]","\udb8c\uddb4"],["ㆵ[̍͘]","\udb8c\uddb5"],["ㆶ[̍͘]","\udb8c\uddb6"],["ㆷ[̍͘]","\udb8c\uddb7"]]},"inaccurate-char":[["[•‧]","\xb7"],["⋯⋯","……"],["──","——"],["‵","‘"],["′","’"],["‶","“"],["″","”"]]}}(),s.UNICODE=o,s.TYPESET=i,s.UNICODE.cjk=s.UNICODE.hanzi,s.UNICODE.greek=s.UNICODE.ellinika,s.UNICODE.cyrillic=s.UNICODE.kirillica,s.UNICODE.hangul=s.UNICODE.eonmun,s.UNICODE.zhuyin.ruyun=s.UNICODE.zhuyin.checked,s.TYPESET.char.cjk=s.TYPESET.char.hanzi,s.TYPESET.char.greek=s.TYPESET.char.ellinika,s.TYPESET.char.cyrillic=s.TYPESET.char.kirillica,s.TYPESET.char.hangul=s.TYPESET.char.eonmun,n={id:function(e,t){return(t||r).getElementById(e)},tag:function(e,t){return this.makeArray((t||r).getElementsByTagName(e))},qsa:function(e,t){return this.makeArray((t||r).querySelectorAll(e))},create:function(e,t){var e="!"===e?r.createDocumentFragment():""===e?r.createTextNode(t||""):r.createElement(e);try{t&&(e.className=t)}catch{}return e},clone:function(e,t){return e.cloneNode("boolean"!=typeof t||t)},remove:function(e){return e.parentNode.removeChild(e)},setAttr:function(e,t){if("object"==typeof t){var n,s,o=t.length;if("object"==typeof t[0]&&"name"in t[0])for(n=0;o>n;n++)0[0]!==t[n].value&&e.setAttribute(t[n].name,t[n].value);else for(s in t)t.hasOwnProperty(s)&&0[0]!==t[s]&&e.setAttribute(s,t[s]);return e}},isIgnorable:function(e){return"WBR"===e.nodeName||e.nodeType===Node.COMMENT_NODE},makeArray:function(e){return Array.prototype.slice.call(e)},extend:function(e,t){var n,s="object"==typeof e||"function"==typeof e||"object"==typeof t;if(s){for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}}},v=function(t){function s(e,t,n){var s=Element.prototype,o=s.matches||s.mozMatchesSelector||s.msMatchesSelector||s.webkitMatchesSelector;return e instanceof Element?o.call(e,t):!!(n&&/^[39]$/.test(e.nodeType))}var n,o="0.2.1",a=t.NON_INLINE_PROSE,r=t.PRESETS.prose.filterElements,c=e||{},i=c.document||0[0];if("undefined"==typeof i)throw new Error("Fibre requires a DOM-supported environment.");return n=function(e,t){return new n.fn.init(e,t)},n.version=o,n.matches=s,n.fn=n.prototype={constructor:n,version:o,finder:[],context:0[0],portionMode:"retain",selector:{},preset:"prose",init:function(e,t){if(t&&(this.preset=null),this.selector={context:null,filter:[],avoid:[],boundary:[]},!e)throw new Error("A context is required for Fibre to initialise.");return e instanceof Node?e instanceof Document?this.context=e.body||e:this.context=e:"string"==typeof e&&(this.context=i.querySelector(e),this.selector.context=e),this},filterFn:function(e){var n=this.selector.filter.join(", ")||"*",o=this.selector.avoid.join(", ")||null,t=s(e,n,!0)&&!s(e,o);return"prose"===this.preset?r(e)&&t:t},boundaryFn:function(e){var n=this.selector.boundary.join(", ")||null,t=s(e,n);return"prose"===this.preset?a(e)||t:t},filter:function(e){return"string"==typeof e&&this.selector.filter.push(e),this},endFilter:function(e){return e?this.selector.filter=[]:this.selector.filter.pop(),this},avoid:function(e){return"string"==typeof e&&this.selector.avoid.push(e),this},endAvoid:function(e){return e?this.selector.avoid=[]:this.selector.avoid.pop(),this},addBoundary:function(e){return"string"==typeof e&&this.selector.boundary.push(e),this},removeBoundary:function(){return this.selector.boundary=[],this},setMode:function(e){return this.portionMode="first"===e?"first":"retain",this},replace:function(e,n){var s=this;return s.finder.push(t(s.context,{find:e,replace:n,filterElements:function(e){return s.filterFn(e)},forceContext:function(e){return s.boundaryFn(e)},portionMode:s.portionMode})),s},wrap:function(e,n){var s=this;return s.finder.push(t(s.context,{find:e,wrap:n,filterElements:function(e){return s.filterFn(e)},forceContext:function(e){return s.boundaryFn(e)},portionMode:s.portionMode})),s},revert:function(e){var n,t=this.finder.length,e=Number(e)||(0===e?0:"all"===e?t:1);if("undefined"==typeof t||0===t)return this;e>t&&(e=t);for(n=e;n>0;n--)this.finder.pop().revert();return this}},n.fn.filterOut=n.fn.avoid,n.fn.init.prototype=n.fn,n}(function(){function a(e){return String(e).replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function e(){return c.apply(null,arguments)||o.apply(null,arguments)}function c(t,n,s,i,a){if(n&&!n.nodeType&&arguments.length<=2)return!1;var c,r="function"==typeof s;return r&&(s=function(e){return function(t,n){return e(t.text,n.startIndex)}}(s)),c=o(n,{find:t,wrap:r?null:s,replace:r?s:"$"+(i||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(i>0){var n=e[i];e.index+=e[0].indexOf(n),e[0]=n}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=t,e},filterElements:a}),e.revert=function(){return c.revert()},!0}function o(e,t){return new s(e,t)}function s(t,s){var i,o=s.preset&&e.PRESETS[s.preset];if(s.portionMode=s.portionMode||l,o)for(i in o)n.call(o,i)&&!n.call(s,i)&&(s[i]=o[i]);this.node=t,this.options=s,this.prepMatch=s.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}var l="retain",i="first",t=r,n=({}.toString,{}.hasOwnProperty);return e.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},e.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},e.NON_INLINE_PROSE=function(t){return n.call(e.NON_CONTIGUOUS_PROSE_ELEMENTS,t.nodeName.toLowerCase())},e.PRESETS={prose:{forceContext:e.NON_INLINE_PROSE,filterElements:function(t){return!n.call(e.NON_PROSE_ELEMENTS,t.nodeName.toLowerCase())}}},e.Finder=s,s.prototype={search:function(){function o(a){for(var c,l=0,d=a.length;d>l;++l)if(c=a[l],"string"==typeof c){if(e.global)for(;t=e.exec(c);)s.push(i.prepMatch(t,r++,n));else(t=c.match(e))&&s.push(i.prepMatch(t,0,n));n+=c.length}else o(c)}var t,r=0,n=0,e=this.options.find,c=this.getAggregateText(),s=[],i=this;return e="string"==typeof e?RegExp(a(e),"g"):e,o(c),s},prepMatch:function(e,t,n){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=n+e.index+e[0].length,e.startIndex=n+e.index,e.index=t,e},getAggregateText:function(){function t(s,o){if(3===s.nodeType)return[s.data];if(n&&!n(s))return[];var a,o=[""],i=0;if(s=s.firstChild)do 3!==s.nodeType?(a=t(s),e&&1===s.nodeType&&(e===!0||e(s))?(o[++i]=a,o[++i]=""):("string"==typeof a[0]&&(o[i]+=a.shift()),a.length&&(o[++i]=a,o[++i]=""))):o[i]+=s.data;while(s=s.nextSibling)return o}var n=this.options.filterElements,e=this.options.forceContext;return t(this.node)},processMatches:function(){var s,o,d,l=this.matches,r=this.node,c=this.options.filterElements,a=[],e=r,t=l.shift(),n=0,h=0,i=0,u=[r];a:for(;;){if(3===e.nodeType&&(!s&&e.length+n>=t.endIndex?s={node:e,index:i++,text:e.data.substring(t.startIndex-n,t.endIndex-n),indexInMatch:n-t.startIndex,indexInNode:t.startIndex-n,endIndexInNode:t.endIndex-n,isEnd:!0}:o&&a.push({node:e,index:i++,text:e.data,indexInMatch:n-t.startIndex,indexInNode:0}),!o&&e.length+n>t.startIndex&&(o={node:e,index:i++,indexInMatch:0,indexInNode:t.startIndex-n,endIndexInNode:t.endIndex-n,text:e.data.substring(t.startIndex-n,t.endIndex-n)}),n+=e.data.length),d=1===e.nodeType&&c&&!c(e),o&&s){if(e=this.replaceMatch(t,o,a,s),n-=s.node.data.length-s.endIndexInNode,o=null,s=null,a=[],t=l.shift(),i=0,h++,!t)break}else if(!d&&(e.firstChild||e.nextSibling)){e.firstChild?(u.push(e),e=e.firstChild):e=e.nextSibling;continue}for(;;){if(e.nextSibling){e=e.nextSibling;break}if(e=u.pop(),e===r)break a}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,t,n){var o=this.options.portionMode;return o===i&&t.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,function(e,t){var s;switch(t){case"&":s=n[0];break;case"`":s=n.input.substring(0,n.startIndex);break;case"'":s=n.input.substring(n.endIndex);break;default:s=n[+t]}return s}),o===i?e:t.isEnd?e.substring(t.indexInMatch):e.substring(t.indexInMatch,t.indexInMatch+t.text.length))},getPortionReplacementNode:function(e,n,s){var a,r,o=this.options.replace||"$&",i=this.options.wrap;return i&&i.nodeType&&(r=t.createElement("div"),r.innerHTML=i.outerHTML||(new XMLSerializer).serializeToString(i),i=r.firstChild),"function"==typeof o?(o=o(e,n,s),o&&o.nodeType?o:t.createTextNode(String(o))):(a="string"==typeof i?t.createElement(i):i,o=t.createTextNode(this.prepareReplacementString(o,e,n,s)),o.data&&a?(a.appendChild(o),a):o)},replaceMatch:function(e,n,s,o){if(a=n.node,r=o.node,a===r)return i=a,n.indexInNode>0&&(l=t.createTextNode(i.data.substring(0,n.indexInNode)),i.parentNode.insertBefore(l,i)),d=this.getPortionReplacementNode(o,e),i.parentNode.insertBefore(d,i),o.endIndexInNode<i.length&&(c=t.createTextNode(i.data.substring(o.endIndexInNode)),i.parentNode.insertBefore(c,i)),i.parentNode.removeChild(i),this.reverts.push(function(){l===d.previousSibling&&l.parentNode.removeChild(l),c===d.nextSibling&&c.parentNode.removeChild(c),d.parentNode.replaceChild(i,d)}),d;for(var i,a,r,d,u,h,m,l=t.createTextNode(a.data.substring(0,n.indexInNode)),c=t.createTextNode(r.data.substring(o.endIndexInNode)),f=this.getPortionReplacementNode(n,e),v=[],p=0,g=s.length;g>p;++p)u=s[p],m=this.getPortionReplacementNode(u,e),u.node.parentNode.replaceChild(m,u.node),this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(u,m)),v.push(m);return h=this.getPortionReplacementNode(o,e),a.parentNode.insertBefore(l,a),a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),r.parentNode.insertBefore(h,r),r.parentNode.insertBefore(c,r),r.parentNode.removeChild(r),this.reverts.push(function(){l.parentNode.removeChild(l),f.parentNode.replaceChild(a,f),c.parentNode.removeChild(c),h.parentNode.replaceChild(r,h)}),h}},e}()),n.extend(v.fn,{jinzify:function(e){return this.filter(e||null).avoid("h-jinze").replace(i.jinze.touwei,function(e,t){var s=n.create("h-jinze","touwei");return s.innerHTML=t[0],0===e.index&&e.isEnd||1===e.index?s:""}).replace(i.jinze.wei,function(e,t){var s=n.create("h-jinze","wei");return s.innerHTML=t[0],0===e.index?s:""}).replace(i.jinze.tou,function(e,t){var s=n.create("h-jinze","tou");return s.innerHTML=t[0],0===e.index&&e.isEnd||1===e.index?s:""}).replace(i.jinze.middle,function(e,t){var s=n.create("h-jinze","middle");return s.innerHTML=t[0],0===e.index&&e.isEnd||1===e.index?s:""}).endAvoid().endFilter()},groupify:function(e){var e=n.extend({biaodian:!1,hanzi:!1,kana:!1,eonmun:!1,western:!1},e||{});return this.avoid("h-hangable, h-char-group, h-word"),e.biaodian&&this.replace(i.group.biaodian[0],O).replace(i.group.biaodian[1],O),(e.hanzi||e.cjk)&&this.wrap(i.group.hanzi,n.clone(n.create("h-char-group","hanzi cjk"))),e.western&&this.wrap(i.group.western,n.clone(n.create("h-word","western"))),e.kana&&this.wrap(i.group.kana,n.clone(n.create("h-char-group","kana"))),(e.eonmun||e.hangul)&&this.wrap(i.group.eonmun,n.clone(n.create("h-word","eonmun hangul"))),this.endAvoid(),this},charify:function(e){var e=n.extend({biaodian:!1,punct:!1,hanzi:!1,latin:!1,ellinika:!1,kirillica:!1,kana:!1,eonmun:!1},e||{});return this.avoid("h-char"),e.biaodian&&this.replace(i.char.biaodian.all,function(e,t){return S(t[0])}).replace(i.char.biaodian.liga,function(e,t){return S(t[0])}),(e.hanzi||e.cjk)&&this.wrap(i.char.hanzi,n.clone(n.create("h-char","hanzi cjk"))),e.punct&&this.wrap(i.char.punct.all,n.clone(n.create("h-char","punct"))),e.latin&&this.wrap(i.char.latin,n.clone(n.create("h-char","alphabet latin"))),(e.ellinika||e.greek)&&this.wrap(i.char.ellinika,n.clone(n.create("h-char","alphabet ellinika greek"))),(e.kirillica||e.cyrillic)&&this.wrap(i.char.kirillica,n.clone(n.create("h-char","alphabet kirillica cyrillic"))),e.kana&&this.wrap(i.char.kana,n.clone(n.create("h-char","kana"))),(e.eonmun||e.hangul)&&this.wrap(i.char.eonmun,n.clone(n.create("h-char","eonmun hangul"))),this.endAvoid(),this}}),s.find=v,void["setMode","wrap","replace","revert","addBoundary","removeBoundary","avoid","endAvoid","filter","endFilter","jinzify","groupify","charify"].forEach(function(e){s.fn[e]=function(){return this.finder||(this.finder=s.find(this.context)),this.finder[e](arguments[0],arguments[1]),this}}),a={},a.writeOnCanvas=p,a.compareCanvases=M,a.detectFont=L,a.support=function(){function t(e){var t,n=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+i.join(n+" ")+n).split(" ");return s.forEach(function(e){"string"==typeof d.style[e]&&(t=!0)}),t}function o(e,t){var i,a,r,s=c||n.create("body"),d=n.create("div"),o=c?d:s,t="function"==typeof t?t:function(){};return i=["<style>",e,"</style>"].join(""),o.innerHTML+=i,s.appendChild(d),c||(s.style.background="",s.style.overflow="hidden",r=l.style.overflow,l.style.overflow="hidden",l.appendChild(s)),a=t(o,e),n.remove(o),c||(l.style.overflow=r),!!a}function s(t,n){var s;return e.getComputedStyle?s=r.defaultView.getComputedStyle(t,null).getPropertyValue(n):t.currentStyle&&(s=t.currentStyle[n]),s}var i="Webkit Moz ms".split(" "),d=n.create("h-test");return{columnwidth:t("columnWidth"),fontface:function(){var e;return o('@font-face { font-family: font; src: url("//"); }',function(t,s){var i=n.qsa("style",t)[0],o=i.sheet||i.styleSheet,a=o?o.cssRules&&o.cssRules[0]?o.cssRules[0].cssText:o.cssText||"":"";e=/src/i.test(a)&&0===a.indexOf(s.split(" ")[0])}),e}(),ruby:function(){var i,e=n.create("ruby"),t=n.create("rt"),o=n.create("rp");return e.appendChild(o),e.appendChild(t),l.appendChild(e),i="none"===s(o,"display")||"ruby"===s(e,"display")&&"ruby-text"===s(t,"display"),l.removeChild(e),e=null,t=null,o=null,i}(),"ruby-display":function(){var e=n.create("div");return e.innerHTML='<h-test-a style="display: ruby;"></h-test-a><h-test-b style="display: ruby-text-container;"></h-test-b>',"ruby"===e.querySelector("h-test-a").style.display&&"ruby-text-container"===e.querySelector("h-test-b").style.display}(),"ruby-interchar":function(){var t,e="inter-character",s=n.create("div");return s.innerHTML='<h-test style="-moz-ruby-position:'+e+";-ms-ruby-position:"+e+";-webkit-ruby-position:"+e+";ruby-position:"+e+';"></h-test>',t=s.querySelector("h-test").style,t.rubyPosition===e||t.WebkitRubyPosition===e||t.MozRubyPosition===e||t.msRubyPosition===e}(),textemphasis:t("textEmphasis"),unicoderange:function(){var e;return o('@font-face{font-family:test-for-unicode-range;src:local(Arial),local("Droid Sans")}@font-face{font-family:test-for-unicode-range;src:local("Times New Roman"),local(Times),local("Droid Serif");unicode-range:U+270C}',function(){e=!a.detectFont("test-for-unicode-range",'Arial, "Droid Sans"',"Q")}),e}(),writingmode:t("writingMode")}}(),a.initCond=function(e){var t,s,e=e||l,n="";for(s in a.support)t=(a.support[s]?"":"no-")+s,e.classList.add(t),n+=t+" ";return n},z=a.support["ruby-interchar"],n.extend(a,{renderRuby:function(e,t){var t=t||"ruby",s=n.qsa(t,e);n.qsa("rtc",e).concat(s).map(k),s.forEach(function(e){var t,n=e.classList;n.contains("complex")?t=y(e):n.contains("zhuyin")&&(t=z?E(e):A(e)),t&&e.parentNode.replaceChild(t,e)})},simplifyRubyClass:k,getZhuyinHTML:f,renderComplexRuby:y,renderSimpleRuby:A,renderInterCharRuby:E}),n.extend(a,{renderElem:function(e){this.renderRuby(e),this.renderDecoLine(e),this.renderDecoLine(e,"s, del"),this.renderEm(e)},renderDecoLine:function(e,t){var t=t||"u, ins",s=n.qsa(t,e),o=new RegExp("^("+t.replace(/,\s?/g,"|")+")$","ig");s.forEach(function(e){var t;do if(t=(t||e).nextSibling,!t)return;while(n.isIgnorable(t))t.nodeName.match(o)&&t.classList.add("adjacent")})},renderEm:function(e,t){var o=t?"qsa":"tag",t=t||"em",i=n[o](t,e);i.forEach(function(e){var t=s(e);a.support.textemphasis?t.avoid("rt, h-char, h-char-group").charify({biaodian:!0,punct:!0}):t.avoid("rt, h-char, h-char-group").jinzify().groupify({western:!0,biaodian:!0}).charify({hanzi:!0,biaodian:!0,punct:!0,latin:!0,ellinika:!0,kirillica:!0})})}}),s.normalize=a,s.localize=a,s.support=a.support,s.detectFont=a.detectFont,s.fn.initCond=function(){return this.condition.classList.add("han-js-rendered"),s.normalize.initCond(this.condition),this},void["Elem","DecoLine","Em","Ruby"].forEach(function(e){var t="render"+e;s.fn[t]=function(e){return s.normalize[t](this.context,e),this}}),n.extend(s.support,{heiti:!0,songti:s.detectFont('"Han Songti"'),"songti-gb":s.detectFont('"Han Songti GB"'),kaiti:s.detectFont('"Han Kaiti"'),fangsong:s.detectFont('"Han Fangsong"')});var N="* > h-hws:first-child, * > wbr:first-child + h-hws, wbr:first-child + wbr + h-hws",m=function(){var e=n.create("div");return e.appendChild(n.create("","0-")),e.appendChild(n.create("","2")),e.normalize(),2!==e.firstChild.length}(),u=n.create("h-hws");return u.setAttribute("hidden",""),u.innerHTML=" ",n.extend(s,{isNodeNormalizeNormal:m,renderHWS:function(e,t){var e=e||r,i=t?"strict":"base",o=s.find(e);return o.avoid(t?"textarea, code, kbd, samp, pre":"textarea"),o.replace(s.TYPESET.hws[i][0],"$1<hws/>$2").replace(s.TYPESET.hws[i][1],"$1<hws/>$2").replace(/(['"]+)<hws\/>(.+?)<hws\/>\1/gi,"$1$2$1").replace(/<hws\/>([\u2018\u201c]+)/gi,"$1").replace(/([\u2019\u201d]+)<hws\/>/gi,"$1").replace("<hws/>",function(){return n.clone(u)}),n.qsa(N,e).forEach(function(e){for(var t=e.parentNode,s=t.firstChild;n.isIgnorable(s);)if(s=s.nextSibling,!s)return;for(;"H-HWS"===s.nodeName&&(n.remove(s,t),s=t.parentNode.insertBefore(n.clone(u),t),t=t.parentNode,m&&t.normalize(),s===t.firstChild););}),m&&e.normalize(),o}}),n.extend(s.fn,{HWS:null,renderHWS:function(e){return s.renderHWS(this.context,e),this.HWS=n.tag("h-hws",this.context),this},revertHWS:function(){return this.HWS.forEach(function(e){n.remove(e)}),this}}),n.extend(s,{detectSpaceFont:d,isSpaceFontLoaded:d()}),s.support["han-space"]=d(),s.renderHanging=function(e){var e=e||r,t=s.find(e);return t.avoid("textarea, code, kbd, samp, pre, h-hangable").replace(i.jinze.hanging,function(e,t){var s=n.create("h-hangable");return s.innerHTML=t[1]+'<h-cs><h-inner hidden> </h-inner><h-char class="biaodian bd-close bd-end cjk">'+t[2]+"</h-char></h-cs>",0===e.index?s:""}),t},n.extend(s.fn,{hanging:null,renderHanging:function(){var e=this.condition.classList,t=d();return t&&e.contains("no-han-space")&&(e.remove("no-han-space"),e.add("han-space")),this.hanging=s.renderHanging(this.context),this},revertHanging:function(){try{this.hanging.revert("all")}catch{}return this}}),s.renderJiya=function(e){var e=e||r,t=s.find(e);return t.avoid("textarea, code, kbd, samp, pre, h-char-group").replace(new RegExp("("+o.biaodian.end+"+)("+o.biaodian.open+"+)","g"),function(e,t){if(0===e.index)return e.isEnd?t[0]:t[1];var s=n.create("h-char-group","biaodian cjk portion");return s.innerHTML=t[2],s}).endAvoid(),t.avoid("textarea, code, kbd, samp, pre, h-char").groupify({biaodian:!0}).charify({biaodian:!0}),n.qsa("h-char.biaodian.bd-open, h-char.biaodian.bd-end",e).forEach(function(e){if(!s.find.matches(e,"h-cs *")){var t="<h-inner>"+e.innerHTML+"</h-inner>",n="<h-cs hidden> </h-cs>",o=e.classList.contains("bd-open");e.innerHTML=o?n+t:t+n}}),t},n.extend(s.fn,{jiya:null,renderJiya:function(){return this.jiya=s.renderJiya(this.context),this},revertJiya:function(){try{this.jiya.revert("all")}catch{}return this}}),b=n.create("h-char","biaodian cjk bd-middle"),b.setAttribute("unicode","b7"),s.correctBasicBD=function(e,t){if(!s.support.unicoderange||t){var e=e||r,o=s.find(e);o.wrap(/\u00B7/g,n.clone(b)).charify({biaodian:!0})}},n.extend(s.fn,{basicBD:null,correctBasicBD:function(e){return this.basicBD=s.correctBasicBD(this.context,e),this},revertBasicBD:function(){try{this.basicBD.revert("all")}catch{}return this}}),j="textarea, code, kbd, samp, pre",F=n.create("h-char","comb-liga"),n.extend(s,{isVowelCombLigaNormal:H(),isVowelICombLigaNormal:_(),isZhuyinCombLigaNormal:D(),isCombLigaNormal:_()(),substVowelCombLiga:h(s.TYPESET["display-as"]["comb-liga-vowel"]),substZhuyinCombLiga:h(s.TYPESET["display-as"]["comb-liga-zhuyin"]),substCombLigaWithPUA:h(s.TYPESET["display-as"]["comb-liga-pua"]),substInaccurateChar:function(e){var e=e||r,t=s.find(e);t.avoid(j),s.TYPESET["inaccurate-char"].forEach(function(e){t.replace(new RegExp(e[0],"ig"),e[1])})}}),n.extend(s.fn,{"comb-liga-vowel":null,"comb-liga-vowel-i":null,"comb-liga-zhuyin":null,"inaccurate-char":null,substVowelCombLiga:function(){return this["comb-liga-vowel"]=s.substVowelCombLiga(this.context),this},substVowelICombLiga:function(){return this["comb-liga-vowel-i"]=s.substVowelICombLiga(this.context),this},substZhuyinCombLiga:function(){return this["comb-liga-zhuyin"]=s.substZhuyinCombLiga(this.context),this},substCombLigaWithPUA:function(){return s.isVowelCombLigaNormal()?s.isVowelICombLigaNormal()||(this["comb-liga-vowel-i"]=s.substVowelICombLiga(this.context)):this["comb-liga-vowel"]=s.substVowelCombLiga(this.context),s.isZhuyinCombLigaNormal()||(this["comb-liga-zhuyin"]=s.substZhuyinCombLiga(this.context)),this},revertVowelCombLiga:function(){try{this["comb-liga-vowel"].revert("all")}catch{}return this},revertVowelICombLiga:function(){try{this["comb-liga-vowel-i"].revert("all")}catch{}return this},revertZhuyinCombLiga:function(){try{this["comb-liga-zhuyin"].revert("all")}catch{}return this},revertCombLigaWithPUA:function(){try{this["comb-liga-vowel"].revert("all"),this["comb-liga-vowel-i"].revert("all"),this["comb-liga-zhuyin"].revert("all")}catch{}return this},substInaccurateChar:function(){return this["inaccurate-char"]=s.substInaccurateChar(this.context),this},revertInaccurateChar:function(){try{this["inaccurate-char"].revert("all")}catch{}return this}}),e.addEventListener("DOMContentLoaded",function(){var e;l.classList.contains("han-init")?s.init():(e=r.querySelector(".han-init-context"))&&(s.init=s(e).render())}),("undefined"==typeof t||t===!1)&&(e.Han=s),s})