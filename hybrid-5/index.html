<!DOCTYPE html>

<html lang="zh-Hans"  dir="ltr"

>

<head>
  <title class="p-name">Hybrid #5 - Rongbin&#39;s Blog</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<meta name="description"
    content="© Jennifer Mehigan https://cowardess.online/




摘录
#


I like to think I mostly get done what I set out to accomplish. My success right there is pretty high in terms of delivering products that have lasting value. I&rsquo;m not the guy to tweak things in production – it’s either a clean piece of paper or a complete disaster. ">
<meta name="author p-author" content="Rongbin FAN" href="https://fanrongbin.com">

<meta property="og:title" content="Hybrid #5 - Rongbin&#39;s Blog" />
<meta property="og:description" content="© Jennifer Mehigan https://cowardess.online/




摘录
#


I like to think I mostly get done what I set out to accomplish. My success right there is pretty high in terms of delivering products that have lasting value. I&rsquo;m not the guy to tweak things in production – it’s either a clean piece of paper or a complete disaster. " />
<meta property="og:url" content="https://fanrongbin.com/hybrid-5/" />
<meta property="og:image" content="https://fanrongbin.com/apple-touch-icon.png" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://fanrongbin.com/apple-touch-icon.png" />
<meta name="twitter:title" content="Hybrid #5 - Rongbin&#39;s Blog" />
<meta name="twitter:description" content="© Jennifer Mehigan https://cowardess.online/




摘录
#


I like to think I mostly get done what I set out to accomplish. My success right there is pretty high in terms of delivering products that have lasting value. I&rsquo;m not the guy to tweak things in production – it’s either a clean piece of paper or a complete disaster. " />

<link rel="canonical" href="https://fanrongbin.com/hybrid-5/" />






      <link rel="stylesheet" href="/css/main.min.ace4cec8417d209e56f17f2a41179ee2229d41357cfecffb2139c21062843cfe.css" integrity="sha256-rOTOyEF9IJ5W8X8qQRee4iKdQTV8/s/7ITnCEGKEPP4=" crossorigin="anonymous">

<link rel="stylesheet" href="/han.min.css" type="text/css">





<link rel="alternate" type="application/activity+json" href="https://fed.brid.gy/r/https://fanrongbin.com/hybrid-5/">

<link rel="webmention" href="https://webmention.io/fanrongbin.com/webmention" />

<script data-goatcounter="https://ron.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>

<body class="han-init-context">

  <section class="navbar">
    <span class="header-name">
    <a href="/" class="header-link h-card p-name p-author u-url u-uid">Rongbin FAN</a>
     / <a href="/posts" class="header-link">Blog</a>
    <br>
    
    <a href="/stream" class="header-link header-guestbook">ϟ Stream</a>
    <a href="/resources" class="header-link header-guestbook">↺ Resources</a>
    <a href="/links" class="header-link header-guestbook">◩ Guestbook</a>
    
</span>


  </section>

  <article class="article-entry h-entry">
      

<section class="content-header">

  <div class="top-scroll-bar"></div>
<div class="addn visible">
<a onclick="showHypo()" style="color:var(--textcolor);text-decoration:none;border:none;"><div id="show-hypo" class="header-button no-select">Hypothes.is</div></a>
<a onclick="toggleTOC()" style="color:var(--textcolor);text-decoration:none;border:none;"><div id="contents-fixed" class="header-button no-select">Contents</div></a>
</div>
<div id="contents-toc" class="no-select">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#摘录">摘录</a></li>
    <li><a href="#更多">更多</a></li>
  </ul>
</nav>
</div>

  

  <div id="single-header">
    <h1 class="p-name content-h1">Hybrid #5</h1>
    

    
      
      
      
        
        <p class="content-time"><time class="dt-published" datetime="2024-12-06T20:29:16&#43;00:00">06 December 2024</time></p>
        
      
    

    <a rel="author" class="p-name h-card" href="https://fanrongbin.com" style="display:none;">Rongbin Fan</a>
  </div>

  

</section>





<style>
  .navbar, footer, .footer-nav, .webmentions-how, .comment-box, .comment-title {
    opacity: 0.35 !important;
  }
  .navbar:hover, footer:hover, .footer-nav:hover, .webmentions-how:hover, .comment-box:hover {
    opacity: 1 !important;
  }
</style>



<div class="link-display"></div>


      
      
      
      <main class="e-content">
      
      














    

    

    

<figure><img src="https://img.fanrongbin.com/Jennifer-Mehigan_DHG_300DPI-54.jpg" alt="© Jennifer Mehigan"></img><figcaption>© Jennifer Mehigan <a href="https://cowardess.online/" target="_blank">https://cowardess.online/</a></figcaption></figure>
<div style="align:middle;">
<iframe allow="autoplay *; encrypted-media *; fullscreen *; clipboard-write" frameborder="0" height="175" style="width:100%;max-width:100%;overflow:hidden;border-radius:10px;background:transparent;" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation" src="https://embed.music.apple.com/cn/album/dating/1405002907?i=1405003097&l=en"></iframe>
</div>
<h2 id="摘录">
摘录
<a href="#%e6%91%98%e5%bd%95" class="heading-anchor">#</a>
</h2>
<blockquote>
<p>I like to think I mostly get done what I set out to accomplish. My success right there is pretty high in terms of delivering products that have lasting value. I&rsquo;m not the guy to tweak things in production – it’s either a clean piece of paper or a complete disaster.</p>
</blockquote>
<p><a href="https://www.anandtech.com/show/16762/an-anandtech-interview-with-jim-keller-laziest-person-at-tesla">An AnandTech Interview with Jim Keller: &lsquo;The Laziest Person at Tesla&rsquo;</a></p>
<blockquote>
<p>One problem with recommendations as the grist for the digital content mill is that there are only so many things to recommend. Repetition, or scalability, is the enemy of taste, because in time it reveals a latent sameness in what we all like to like. Bainbridge acknowledged the problem: “You want to feel unique and you want to feel like you have your own thing. The minute more people are talking about Bar Italia”—an indie London rock band—“or whatever, you feel like you’re less of an individual.” Sharing recommendations online now can present a quandary when it comes to spreading things you are deeply, personally passionate about: if the algorithmic content feeds get hold of it, it’s likely to be blasted to millions of people and erode your personal claim to whatever the thing is that you love. (Or worse, fed into the maw of generative A.I. and reproduced.) A restaurant grows insurmountably booked; a musician’s work gets churned through social-media discourse. It might be safer just to recommend nasal spray.</p>
</blockquote>
<p><a href="https://www.newyorker.com/culture/infinite-scroll/the-banality-of-online-recommendation-culture">The Banality of Online Recommendation Culture - The New Yorker</a></p>
<blockquote>
<p>The costs of never finishing extend far beyond just missed opportunities. While starting projects might expose you to new technologies or concepts, it’s in the act of finishing — of solving those last, trickiest problems — where real <em>skill growth</em> often occurs. Each unfinished project can chip away at your confidence. Over time, you might start to doubt your ability to complete anything substantial, creating a self-fulfilling prophecy of incompletion.</p>
</blockquote>
<p><a href="https://www.bytedrum.com/posts/art-of-finishing">The Art of Finishing - ByteDrum</a></p>
<blockquote>
<p>但是，去對我們身處的時代下一個賭注又是何其孤注，一個人在母體之外寫母體裏的故事，那種身首異處的錯位感是極其凜冽的，像自己身上那根文化的臍帶在太平洋上斷成兩截，從此你開始在新大陸上尋找新的榫卯，一切只為了讓自己有根。我生長的故土，實則是一個東方和西方不斷拉扯和聯姻的農村舊式舞台，百多年前的摧枯拉朽暗合了近些年倒著轉的輪迴，真是一再否定，一再螺旋，都讓我無從知曉自己到底處於世界史的何種座標。你只感到你像是背著一個戴滿了翠玉花鈿的老嫗，在「時間的無垠的荒涯」上一會兒往東一會兒往西，顛到哪兒，哪兒就是原點。</p>
</blockquote>
<p><a href="https://theinitium.com/article/20220409-strangers-study-screenwriting-in-canada">異鄉人：在自己的母語裏流浪，我在加拿大學編劇</a></p>
<blockquote>
<p>Yet the end point for the working artist is to create an object for sale. Once the art object enters the market, art’s intrinsic value is emptied out, compacted by the market’s logic of ranking, until there’s only relational worth, no interior worth. Two novelists I know publish essays one week apart; in a grim coincidence, each writer recounts their own version of the same traumatic life event. Which essay is better, a friend asks. I explain they’re different; different life circumstances likely shaped separate approaches. Yes, she says, but which one is <em>better</em>?</p>
</blockquote>
<p><a href="https://thewalrus.ca/collapse-of-self-worth-in-the-digital-age/">The Collapse of Self-Worth in the Digital Age - The Walrus</a></p>
<blockquote>
<p>I used to blame advertisers for that restlessness and dissatisfaction, but I don’t think that’s right. We were already restless; we always have been. The advertisers just figured out how to nurture, tend, exacerbate, and capitalize on the pre-existing condition, that innate restlessness, promising that something new is going to set all to rights. When the flashing sidebar connects that hand lotion, those hiking boots, a beach vacation, or some rugged SUV with satisfaction, joy, and inner peace, it sure <em>feels</em> like we’d be suckers <em>not</em> to buy it. And when that thing inevitably disappoints, we hardly even notice. There’s always something new to buy. That narrative of elusive satisfaction isn’t just something we’re repeatedly being told; it is a story we’re literally buying into all the time. No surprise, then, that when our beloved to whom we once upon a time “pledged our troth” inevitably disappoints, we start thinking it might be time to get a new beloved.</p>
</blockquote>
<p><a href="https://comment.org/repair-and-remain">Repair and Remain - Comment</a></p>
<p>刚好在听：<a href="https://www.youtube.com/watch?v=xEiD1wQ5EvU">当你离开的时候 - 蔡健雅</a>。</p>
<blockquote>
<p>Good thinking is about pushing past your current understanding and reaching the thought behind the thought. This often requires breaking old ideas, which is much easier to do when the ideas are as rigid as they get on the page. In a fluid medium like thought or conversation, you can always go, “Well, I didn’t mean it like <em>that</em>” or rely on the fact that your short-term memory is too limited for you to notice the contradiction between what you are saying now and what you said 12 minutes ago.</p>
<p>[&hellip;]</p>
<blockquote>
<p>You are interested only in proofs which ‘prove’ what they have set out to prove. I am interested in proofs even if they do not accomplish their intended task. Columbus did not reach India but he discovered something interesting.</p>
<p>—Lakatos</p>
</blockquote>
<p>[&hellip;]</p>
<p>There are several subtle problems with this conclusion. But the point is—these problems didn’t come into view until we had stretched and probed our original position.</p>
</blockquote>
<p><a href="https://www.henrikkarlsson.xyz/p/writing-to-think">How to think in writing - Escaping Flatland</a></p>
<blockquote>
<ol start="30">
<li>Time seems to speed up as you get older. And you wonder—is it biological, or is it because life had more novelty when you were a child? Travel partly answers this question—with more novelty, time slows way down again.</li>
<li>My favorite part of of travel is the perspective it gives on “regular” life. Why do I live the way I do? Is the stuff I do for work what I want to be doing? Should I blog about a “topic” instead of whatever shiny object last caught my eye? These thoughts seem healthy but also… not particularly related to traveling? If you <em>designed</em> an experience to create this kind of perspective, what would that look like?</li>
</ol>
<p>[&hellip;]</p>
<ol start="40">
<li>Most people incorrectly prefer aisle seats to window seats. They’re sure to discover their error sooner or later, but in the meantime, use it to your advantage.</li>
<li>Many of the people who seem “best” at travel seem to be really good at <em>having sensory experiences</em>—at shutting down the internal dialog and letting the sights and sounds and smells wash over them. I am by nature horrendous at having sensory experiences, but if I make a conscious choice, then it’s pretty easy and often quite profound.</li>
<li>Don’t confuse scarcity with value. A really good afternoon in the park (a <em>really</em> good one) is maybe about as good as it gets.</li>
<li>Travel reveals the value of stability, roots, routine, community, relationships, and cooking at home.</li>
</ol>
</blockquote>
<p><a href="https://dynomight.net/travel">Obvious travel advice - Dynomight</a></p>
<h2 id="更多">
更多
<a href="#%e6%9b%b4%e5%a4%9a" class="heading-anchor">#</a>
</h2>
<ul>
<li><a href="https://www.bbc.com/zhongwen/trad/world-64891644">BBC紀錄片：走近柬埔寨詐騙園的「殺豬盤」愛情陷阱</a></li>
<li><a href="https://larahogan.me/blog/be-a-thermostat-not-a-thermometer/">Be a thermostat, not a thermometer</a></li>
<li><a href="https://ukfoundations.co/">Foundations - Why Britain has stagnated</a></li>
<li><a href="https://mitadmissions.org/blogs/entry/how-to-restore-an-old-whiteboard/">how to restore an old whiteboard, mit style by Paolo A. &lsquo;21 G</a></li>
<li><a href="https://kinopio.club/">Kinopio</a></li>
<li><a href="https://makeityourself.org/">Make it Yourself - 1000 Useful Things to Make</a></li>
<li><a href="https://www.hubermanlab.com/topics/nsdr-meditation-and-breathwork">NSDR, Meditation and Breathwork</a></li>
<li><a href="https://tally.so/">Tally</a></li>
<li><a href="https://thelongcontext.com/">You Exist In The Long Context</a></li>
</ul>



          
      
          <a class="u-url" href="https://fanrongbin.com/hybrid-5/" hidden="from-humans" style="display:none;"></a>
      

      </main>
      
      
      <a class="u-bridgy-fed" rel="bridgy" href="https://fed.brid.gy/" hidden="from-humans" style="display:none;"></a>

  
  </article>
  

  
  



<div class="footer-nav">




<div class="previous-post" style="display:inline-block;">
  
    
      <a class="no-external" href="/story-behind-calinda/"><span class="arrow">←</span> The Story behind Calinda</a>
    
  
</div>




  <div class="Tags">
    <ul style="list-style-type: none;margin:0;">
      <li class="label">TAGS</li>
        <li><a href="/tags/hybrid/">Hybrid</a></li>
    </ul>
  </div>

<div class="next-post" style="display:inline-block;float:right;">
  
</div>

</div>






  

<h2 class="comment-title">Comment</h2>

<details class="comment-box">
  <summary>Login via Github</summary>
<div id="giscus">
  <script id="giscus-script" src="https://giscus.app/client.js" data-repo="rongbinf/giscus-comment"
      data-repo-id="R_kgDOK3UYzw" data-category="Announcements"
      data-category-id="DIC_kwDOK3UYz84Cbl2R" data-mapping="pathname" data-strict="0"
      data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top"
      data-theme="https://fanrongbin.com/giscus.css" data-lang="en" data-loading="lazy"
      crossorigin="anonymous" defer>
      </script>
</div>
</details>


<details class="comment-box">
  <summary>No Login</summary>
  <div id="tcomment"></div>
  <script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js" integrity="sha384-4KfOjEinLSkv1i1J8TzlkC/RTnuiLoR1OLerVgjEKoH5djYtbf7mzEFsz9p3nfuA" crossorigin="anonymous" onload="initTwikoo()" defer></script>
  <script>
  function initTwikoo() {
    twikoo.init({
      envId: 'https://twikoo.fanrongbin.com',
      el: '#tcomment',
      lang: 'en',
    });
  }
  </script>
  <style>
    .twikoo svg{
      margin: 0;
    }
    .tk-avatar .tk-avatar-img {
      margin: 0;
    }
    .el-input-group__append, .el-input-group__prepend {
      background-color: unset !important;
      border: unset !important;
    }
    .el-input__inner, .el-textarea__inner {
      border: 0;
      border-bottom: 1px solid var(--text-color);
      border-radius: 0;
    }
    .el-input.is-active .el-input__inner, .el-input__inner:focus,
    .twikoo .el-input__inner:focus, .twikoo .el-textarea__inner:focus {
      border-color: var(--text-color) !important;
    }
    .el-button--primary {
      background-color: var(--highlight) !important;
    }
    .el-button--primary.is-disabled {
      background-color: var(--highlight) !important;
      border: 0 !important;
      opacity: 0.5 !important;
    }
    .twikoo .el-button:not(.el-button--primary):not(.el-button--text):hover {
      border-color: white !important;
      background-color: var(--highlight) !important;
      color: white !important;
    }
    .tk-submit-action-icon.__markdown {
      border: none;
    }
    .tk-submit-action-icon.__markdown::after {
      content: none;
    }
    .tk-icon.__comments {
      color: var(--highlight);
    }
  </style>
</details>

<details class="comment-box">
  <summary>Webmention</summary>
  <script src="/webmention.min.js" defer></script>
  <div id="webmentions"></div>
  <div>
    <p>
      
      What is <a
    href="/hugo-webmention-bridgy-mastodon">Webmention</a>?</p>
    <form class="webmention-form" action="https://webmention.io/fanrongbin.com/webmention" method="post" style="margin: 2ch 0;">
          <input type="url" name="source" class="url" placeholder="Your URL" required="">
          <input type="hidden" name="target" value="https://fanrongbin.com/hybrid-5/">
          <input type="submit" value="Send" style="background:var(--bg-color);">
    </form>
  </div>
</details>

<details class="comment-box" onclick="showHypo();">
  <summary><a id="commenthypo" onclick="showHypo();">Hypothes.is</a></summary>
  </details>



  

  <footer class="opacity-6">
    <p><a href="/colophon">Colophon</a></p><p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a></p>
  </footer>

</body>

<script src="/han.min.js" defer></script>



<script type="application/json" class="js-hypothesis-config" defer>
{
    "sideBySide": {
        "mode": "manual"
    }
}
</script>

<script defer>
    var mainElement = document.querySelector('main');
    var contentHeader = document.querySelector('section.content-header');
    const headers = mainElement.querySelectorAll('h2, h3');
    document.addEventListener('DOMContentLoaded', function () {

        if (contentHeader) {
            contentHeader.querySelector('#show-hypo').style.display = 'flex';
        }

        handleScrollEvents();

        applyBreakAllClass();

        setupSidenotes();

        initializeMutationObserver();

        initializeTOCFeatures();

        preventMultiTouchGestures();

        setExternalLinksToOpenInNewTab();
    });

    function updateHHangableBehavior() {
        var sidenoteHangables = mainElement.querySelectorAll('.sidenote-number + h-hangable');
        sidenoteHangables.forEach(function (hHangable) {
            var sidenoteNumber = hHangable.previousElementSibling;
            var sidenoteBox = sidenoteNumber.querySelector('.sidenote-box');
            if (sidenoteBox) {
                sidenoteNumber.insertBefore(hHangable, sidenoteBox);
            }
        });
    }

    function initializeMutationObserver() {
        var observer = new MutationObserver(function (mutations) {
            var shouldUpdate = false;
            mutations.forEach(function (mutation) {
                mutation.addedNodes.forEach(function (node) {
                    if (node.nodeType === 1 && node.matches('h-hangable')) {
                        var previousSibling = node.previousElementSibling;
                        if (previousSibling && previousSibling.matches('.sidenote-number')) {
                            shouldUpdate = true;
                        }
                    }
                });
            });
            if (shouldUpdate) {
                setTimeout(updateHHangableBehavior, 1200);
            }
        });

        var config = { childList: true, subtree: true };
        if (mainElement) {
            observer.observe(mainElement, config);
        }
    }

    function applyBreakAllClass() {
        var screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        var codeElements = mainElement.querySelectorAll('code');

        codeElements.forEach(function (element) {
            if (screenWidth <= 960) {
                if (element.textContent.length > 10) {
                    element.classList.add('break-all');
                }
            }
            else {
                if (element.textContent.length > 30) {
                    element.classList.add('break-all');
                }
            }
        });
    }

    function handleScrollEvents() {
        if (contentHeader) {
            let lastScrollTop = 0;
            let isScrolling = false;
            const addnDiv = contentHeader.querySelector('.addn');
            const topScrollBar = contentHeader.querySelector('.top-scroll-bar');

            window.addEventListener('scroll', function () {
                const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                if (!isScrolling) {
                    window.requestAnimationFrame(function () {
                        if (topScrollBar) {
                            const scrollPercent = (currentScroll / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                            topScrollBar.style.width = scrollPercent + '%';
                            topScrollBar.style.display = 'block';
                        }
                        if (addnDiv) {
                            if (currentScroll > lastScrollTop && currentScroll > 50) {
                                addnDiv.classList.remove('visible');
                            } else {
                                addnDiv.classList.add('visible');
                            }
                        }
                        lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
                        isScrolling = false;
                    });
                    isScrolling = true;
                }
                if (window.innerWidth >= 1600) {
                    toggleTOCOnScroll();
                }
            }, false);
        }
    }

    function showHypo() {
        var existingScript = document.getElementById('hypothes-script');
        var button = contentHeader.querySelector('#show-hypo');

        var commentHypo = document.getElementById("commenthypo");

        if (!existingScript) {
            button.textContent = 'Loading';
            commentHypo.textContent = 'Loading'

            var script = document.createElement('script');
            script.id = 'hypothes-script';
            script.src = 'https://hypothes.is/embed.js';

            script.onload = () => {
                button.textContent = 'Hypothes.is';
                commentHypo.textContent = 'You can now select texts to highlight or note.'
            };

            script.onerror = () => {
                button.style.color = 'red';
                button.textContent = 'Failed';
                commentHypo.textContent = 'Network error. Please refresh and try again.'
            };

            
            document.body.appendChild(script);
        } else {
            toggleHypothesisElementsVisibility();
            button.style.color = 'var(--text-color)';
        }
    }

    function toggleHypothesisElementsVisibility() {
        const elementsToToggle = [
            'hypothesis-sidebar',
            'hypothesis-notebook',
            'hypothesis-profile',
            'hypothesis-adder',
            'hypothesis-highlight-cluster-toolbar'
        ];

        elementsToToggle.forEach(function (element) {
            var el = document.querySelector(element);
            if (el) {
                if (el.style.display === 'none') {
                    el.style.display = '';
                } else {
                    el.style.display = 'none';
                }
            }
        });
    }


    function initializeTOCFeatures() {
        if (contentHeader) {
            const contentsFixedDiv = contentHeader.querySelector('#contents-fixed');
            const tocContainer = contentHeader.querySelector('#contents-toc');
            if (contentsFixedDiv && headers.length > 1) {
                contentsFixedDiv.style.display = 'flex';
                contentsFixedDiv.addEventListener('click', (event) => {
                    toggleTOC();
                    event.stopPropagation();
                });
            }
            if (tocContainer && !tocContainer.dataset.initialized) {
                const throttledHighlight = throttle(highlightAppropriateHeader, 250);
                window.addEventListener('scroll', throttledHighlight);
                tocContainer.dataset.initialized = 'true';
            }
        }
    }

    function highlightAppropriateHeader() {
        let highlightedHeader = null;
        let foundHeaderInView = false;

        
        for (let i = 0; i < headers.length; i++) {
            const header = headers[i];
            const bounding = header.getBoundingClientRect();

            if (bounding.top >= 0 && bounding.bottom <= window.innerHeight) {
                highlightedHeader = header; 
                foundHeaderInView = true;
                break;
            }
        }

        
        if (!foundHeaderInView) {
            for (let i = 0; i < headers.length; i++) {
                const header = headers[i];
                let nextHeader = headers[i + 1];
                let endOfSection = nextHeader ? nextHeader.getBoundingClientRect().top : Infinity;

                const startOfSection = header.getBoundingClientRect().bottom;

                if (startOfSection < window.innerHeight && endOfSection > 0) {
                    highlightedHeader = header;
                    break;
                }
            }
        }

        
        contentHeader.querySelectorAll('nav#TableOfContents a').forEach(link => {
            link.classList.remove('toc-highlight');
        });

        
        if (highlightedHeader) {
            const link = contentHeader.querySelector(`nav#TableOfContents a[href="#${highlightedHeader.id}"]`);
            if (link) {
                link.classList.add('toc-highlight');
            }
        }
    }

    function toggleTOC() {
        const tocContainer = contentHeader.querySelector('#contents-toc');
        const isDisplayed = window.getComputedStyle(tocContainer).display !== 'none';
        tocContainer.style.display = isDisplayed ? 'none' : 'flex';
    }

    function toggleTOCOnScroll() {
        const tocContainer = document.querySelector('#TableOfContents');
        const footerNav = document.querySelector('.footer-nav');

        if (!tocContainer || !footerNav) return;

        const footerNavTop = footerNav.getBoundingClientRect().top;
        const windowHeight = window.innerHeight;

        
        if (footerNavTop <= windowHeight) {
            tocContainer.style.display = 'none';
        } else {
            tocContainer.style.display = 'flex';
        }
    }

    function throttle(func, limit) {
        let lastFunc;
        let lastRan;
        return function () {
            const context = this;
            const args = arguments;
            if (!lastRan) {
                func.apply(context, args);
                lastRan = Date.now();
            } else {
                clearTimeout(lastFunc);
                lastFunc = setTimeout(function () {
                    if ((Date.now() - lastRan) >= limit) {
                        func.apply(context, args);
                        lastRan = Date.now();
                    }
                }, limit - (Date.now() - lastRan));
            }
        }
    }

    function setExternalLinksToOpenInNewTab() {
        const links = document.querySelectorAll('.e-content a[href*="//"]:not(.stream-url):not(.stream-time)');
        const linkDisplay = document.querySelector('.link-display');

        links.forEach(function (link) {
            link.setAttribute('target', '_blank');

            link.addEventListener('mouseover', function () {
                const url = new URL(this.href);
                const rootDomain = url.hostname.replace(/^www\./, '');
                const boldDomain = `<span class="bold-domain">${rootDomain}</span>`;
                const displayUrl = this.href.replace(rootDomain, boldDomain);

                linkDisplay.innerHTML = displayUrl;
                linkDisplay.style.display = 'block';
                const linkRect = this.getBoundingClientRect();
                linkDisplay.style.top = `${linkRect.bottom + window.scrollY}px`;
                linkDisplay.style.left = `${linkRect.left + window.scrollX}px`;
            });

            link.addEventListener('mouseout', function () {
                linkDisplay.style.display = 'none';
            });
        });
    }

    function setupSidenotes() {
    const sidenoteNumbers = mainElement.querySelectorAll('.sidenote-number');

    if (sidenoteNumbers.length >= 3 && window.innerWidth >= 1000) {
        const sidenoteLine = mainElement.querySelectorAll('.sidenote-line');
        sidenoteLine.forEach(element => {
            element.style.border = 'none';
        });

        var jQueryScript = document.createElement('script');
        jQueryScript.src = '/jquery-3.6.0.min.js';
        document.head.appendChild(jQueryScript);

        jQueryScript.onload = function () {
            var jsPlumbScript = document.createElement('script');
            jsPlumbScript.src = '/jsplumb.min.js';
            document.head.appendChild(jsPlumbScript);

            jsPlumbScript.onload = function () {
                initJsPlumb();
            };
        };
    }

    function applySidenoteMargins() {
        const screenWidth = window.innerWidth;

        if (screenWidth <= 1000) {
            sidenoteNumbers.forEach(sidenoteNumber => {
                const sidenoteBox = sidenoteNumber.querySelector('.sidenote-box');
                const afterSidenoteContent = sidenoteNumber.nextSibling;

                if (sidenoteBox) {
                    if (afterSidenoteContent && afterSidenoteContent.textContent.trim() !== "") {
                        sidenoteBox.style.marginBottom = "0"; 
                    }
                }
            });
        } else {
            sidenoteNumbers.forEach(sidenoteNumber => {
                const sidenoteBox = sidenoteNumber.querySelector('.sidenote-box');
                if (sidenoteBox) {
                    sidenoteBox.style.marginBottom = "";  
                }
            });
        }
    }

    applySidenoteMargins();

    window.addEventListener('resize', applySidenoteMargins);
}


    function initJsPlumb() {
        var jsPlumbCSS = document.createElement('link');
        jsPlumbCSS.href = '/jsplumbtoolkit-defaults.min.css';
        jsPlumbCSS.rel = 'stylesheet';
        document.head.appendChild(jsPlumbCSS);

        jQuery(document).ready(function () {
            jsPlumb.importDefaults({
                ConnectionsDetachable: false,
                ReattachConnections: false,
                Endpoint: "Blank",
                Connector: ["Straight"],
                PaintStyle: { stroke: "var(--text-color)", strokeWidth: 1 }
            });

            createConnections();
            var resizeObserver = new ResizeObserver(function () {
                createConnections();
            });
            resizeObserver.observe(document.body);
        });
    }

    function createConnections() {
        jsPlumb.deleteEveryEndpoint();
        jQuery('.sidenote-number').each(function () {
            var sidenoteNumber = jQuery(this);
            var sidenote = sidenoteNumber.find('.sidenote');

            if (sidenote.length) {
                jsPlumb.connect({
                    source: sidenoteNumber[0],
                    target: sidenote[0],
                    anchors: ["Center", "RightMiddle"],
                    cssClass: "jsplumb-line"
                });
            }
        });
    }


    function preventMultiTouchGestures() {
        window.onload = function () {
            document.addEventListener('touchstart', function (event) {
                if (event.touches.length > 1) {
                    event.preventDefault();
                }
            }, false);
            var lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                var now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            document.addEventListener('gesturestart', function (event) {
                event.preventDefault();
            }, false);
        }
    }
</script>

</html>