async function fetchMBID(e,t){const n=`release:${e} AND artist:${t}`,s=`https://musicbrainz.org/ws/2/release-group/?query=${encodeURIComponent(n)}&fmt=json`,o=await fetch(s,{headers:{"User-Agent":"YourAppName/1.0 ( your@email.com )"}}),i=await o.json(),a=i["release-groups"]?.[0];return a?.id||null}async function fetchCoverArt(e){const n=`https://coverartarchive.org/release-group/${e}`,s=await fetch(n),t=await s.json();return t.images[0]?.thumbnails?.large||t.images[0]?.image}const observer=new IntersectionObserver(e=>{e.forEach(async e=>{if(!e.isIntersecting)return;const t=e.target,n=t.dataset.album,s=t.dataset.artist;try{const e=await fetchMBID(n,s);if(!e)throw new Error("找不到 MBID");const a=await fetchCoverArt(e),o=new Image;o.src=a,o.classList.add("w-full","h-full","object-cover","transition","duration-500","scale-100"),t.querySelector(".cover").replaceWith(o);const i=t.querySelector("a");i&&(i.href=`https://musicbrainz.org/release-group/${e}`)}catch(e){console.warn(`加载失败: ${n} - ${s}`,e)}observer.unobserve(t)})},{threshold:.1,rootMargin:"200px"});document.querySelectorAll(".record").forEach(e=>observer.observe(e))